<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{admin/layout}">
<head>
<title>Quản lý Danh mục</title>
</head>
<body>
	<div layout:fragment="content">
		<div class="container-fluid px-4 mt-4">

			<div class="d-flex justify-content-between align-items-center mb-4">
				<div>
					<h2 class="mb-0 fw-bold text-primary">
						<i class="fas fa-layer-group me-2"></i>Danh mục sản phẩm
					</h2>
					<p class="text-muted mb-0">Quản lý các loại sản phẩm trong hệ
						thống</p>
				</div>
				<a th:href="@{/admin/categories/add}"
					class="btn btn-primary shadow-sm"> <i class="fas fa-plus me-2"></i>Thêm
					mới
				</a>
			</div>

			<div class="card shadow-sm border-0 mb-4 bg-light">
				<div class="card-body py-3">
					<form th:action="@{/admin/categories}" method="get"
						class="row g-2 align-items-center">
						<div class="col-auto">
							<label class="fw-bold text-secondary">Tìm kiếm:</label>
						</div>
						<div class="col-md-4">
							<div class="input-group">
								<span class="input-group-text bg-white border-end-0"><i
									class="fas fa-search text-muted"></i></span> <input type="text"
									class="form-control border-start-0 ps-0" name="name"
									th:value="${name}" placeholder="Nhập tên danh mục...">
							</div>
						</div>
						<div class="col-auto">
							<button type="submit" class="btn btn-dark">Lọc dữ liệu</button>
							<a th:href="@{/admin/categories}"
								class="btn btn-outline-secondary" title="Làm mới"> <i
								class="fas fa-sync-alt"></i>
							</a>
						</div>
					</form>
				</div>
			</div>

			<div th:if="${categoryPage.empty}" class="text-center py-5">
				<img src="https://cdn-icons-png.flaticon.com/512/7486/7486754.png"
					width="100" class="mb-3 opacity-50" alt="Empty">
				<h5 class="text-muted">Chưa có dữ liệu danh mục nào.</h5>
				<p class="text-muted small">Hãy thêm danh mục mới để bắt đầu.</p>
			</div>

			<div class="card shadow border-0" th:unless="${categoryPage.empty}">
				<div class="card-body p-0">
					<div class="table-responsive">
						<table class="table table-hover table-striped align-middle mb-0">
							<thead class="bg-light text-uppercase text-secondary small">
								<tr>
									<th class="py-3 px-4" style="width: 50px;">ID</th>
									<th class="py-3" style="width: 120px;">Hình ảnh</th>
									<th class="py-3">Tên Danh mục</th>
									<th class="py-3">Mã Code</th>
									<th class="py-3">Người quản lý</th>
									<th class="py-3 text-center">Trạng thái</th>
									<th class="py-3 text-end px-4">Hành động</th>
								</tr>
							</thead>
							<tbody>
								<tr th:each="category : ${categoryPage.content}">
									<td class="px-4 fw-bold text-muted" th:text="${category.id}"></td>

									<td>
										<div class="position-relative"
											style="width: 60px; height: 60px;">
											<img th:if="${category.images != null}"
												th:src="@{/image(fname=${category.images})}"
												class="w-100 h-100 object-fit-cover rounded border shadow-sm"
												alt="Img" />

											<div th:unless="${category.images != null}"
												class="w-100 h-100 bg-secondary bg-opacity-10 rounded d-flex align-items-center justify-content-center text-muted small">
												<i class="fas fa-image"></i>
											</div>
										</div>
									</td>

									<td><span class="fw-semibold text-dark"
										th:text="${category.name}"></span></td>

									<td><span
										class="badge bg-light text-dark border font-monospace"
										th:text="${category.code}"></span></td>

									<td>
										<div class="d-flex align-items-center"
											th:if="${category.user != null}">
											<div
												class="avatar-sm bg-primary text-white rounded-circle me-2 d-flex align-items-center justify-content-center"
												style="width: 25px; height: 25px; font-size: 10px;">
												<i class="fas fa-user"></i>
											</div>
											<span class="small" th:text="${category.user.username}"></span>
										</div> <span class="text-muted small fst-italic"
										th:unless="${category.user != null}">Chưa gán</span>
									</td>

									<td class="text-center"><span th:if="${category.status}"
										class="badge bg-success bg-opacity-10 text-success rounded-pill px-3">
											<i class="fas fa-check-circle me-1"></i>Hoạt động
									</span> <span th:unless="${category.status}"
										class="badge bg-danger bg-opacity-10 text-danger rounded-pill px-3">
											<i class="fas fa-lock me-1"></i>Đang khóa
									</span></td>

									<td class="text-end px-4">
										<div class="btn-group">
											<a th:href="@{'/admin/categories/edit/' + ${category.id}}"
												class="btn btn-sm btn-outline-primary" title="Chỉnh sửa">
												<i class="fas fa-pen"></i>
											</a> <a th:href="@{'/admin/categories/delete/' + ${category.id}}"
												class="btn btn-sm btn-outline-danger"
												onclick="return confirm('Bạn có chắc chắn muốn xóa danh mục này? Hành động này không thể hoàn tác!');"
												title="Xóa"> <i class="fas fa-trash-alt"></i>
											</a>
										</div>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>

				<div class="card-footer bg-white py-3">
					<div class="row align-items-center">
						<div class="col-md-6 text-muted small">
							Hiển thị <strong>[[${categoryPage.numberOfElements}]]</strong>
							trên tổng số <strong>[[${categoryPage.totalElements}]]</strong>
							bản ghi.
						</div>

						<div class="col-md-6" th:if="${categoryPage.totalPages > 1}">
							<nav aria-label="Page navigation">
								<ul class="pagination justify-content-end mb-0 pagination-sm">
									<li class="page-item"
										th:classappend="${categoryPage.first} ? 'disabled'"><a
										class="page-link"
										th:href="@{/admin/categories(name=${name}, page=${categoryPage.number})}"
										aria-label="Previous"> <span aria-hidden="true">&laquo;</span>
									</a></li>

									<li class="page-item" th:each="pageNumber : ${pageNumbers}"
										th:classappend="${pageNumber == categoryPage.number + 1} ? 'active'">
										<a class="page-link"
										th:href="@{/admin/categories(name=${name}, page=${pageNumber})}"
										th:text="${pageNumber}">1</a>
									</li>

									<li class="page-item"
										th:classappend="${categoryPage.last} ? 'disabled'"><a
										class="page-link"
										th:href="@{/admin/categories(name=${name}, page=${categoryPage.number + 2})}"
										aria-label="Next"> <span aria-hidden="true">&raquo;</span>
									</a></li>
								</ul>
							</nav>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>
</html>